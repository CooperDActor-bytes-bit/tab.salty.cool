function notepad__window_show(){notepad_window.style.display="",notepad_window.dataset.show="true",notepad_window.classList.remove("animation__notepad_window_hide"),notepad_window.classList.add("animation__notepad_window_show")}function notepad__window_hide(){notepad_window.classList.remove("animation__notepad_window_show"),notepad_window.classList.add("animation__notepad_window_hide")}function notepad__empty_manager(){qsAll(".notepad_window_item").length>0?notepad_window_empty.style.display="none":notepad_window_empty.style.display=""}function notepad__item_click(e){let t=qs(".notepad_window_item_active");t&&t.classList.remove("notepad_window_item_active");let n=qs('.notepad_window_item[data-id="'+e+'"]');n&&(n.classList.add("notepad_window_item_active"),localStorage.setItem("notepad_active_item_id",e),notepad_window_textarea.dataset.item_id=e,notepad_window_textarea.classList.remove("notepad_window_textarea_inactive"),chromels("get","notepad_item_"+e+"_value",!1,(function(e){e||(e=""),notepad_window_textarea.value=e,notepad_window_textarea.focus()})))}let notepad_btn=qs("#notepad_btn"),notepad_window=qs(".notepad_window"),notepad_window_textarea=qs(".notepad_window_textarea"),notepad_add=qs("#notepad_add"),notepad_window_empty=qs(".notepad_window_empty"),notepad_window_items=qs(".notepad_window_items");notepad_window.addEventListener("animationend",(function(e){e.target.classList.contains("notepad_window")&&"animation__notepad_window_hide"===e.animationName&&(notepad_window.style.display="none",notepad_window.dataset.show="false")})),document.addEventListener("mousedown",(function(e){e.target.matches(".notepad, .notepad *")||"true"===notepad_window.dataset.show&&notepad__window_hide()})),notepad_btn.addEventListener("click",(function(){"true"===notepad_window.dataset.show?notepad__window_hide():notepad_append__go((function(){notepad__empty_manager(),notepad__window_show();let e=localStorage.getItem("notepad_active_item_id");e||(e="0"),notepad__item_click(e)}))})),notepad_add.addEventListener("click",(function(){notepad_append__create_item_data("New sheet",ut(),(function(e){notepad_append__create_item(e,!0),notepad__item_click(e),notepad_append__index_items_manager(),notepad__empty_manager()}))})),notepad_window_items.addEventListener("click",(function(e){if(e.target.classList.contains("notepad_window_item")){notepad__item_click(e.target.dataset.id)}})),notepad_window_items.addEventListener("click",(function(e){if("notepad_window_item_remove"===e.target.dataset.uid){let t=e.target.parentNode.dataset.id;notepad_window_textarea.dataset.item_id===t&&(notepad_window_textarea.dataset.item_id="false",notepad_window_textarea.classList.add("notepad_window_textarea_inactive")),notepad_append__remove_item(t,(function(){notepad_append__index_items_manager(),notepad__empty_manager(),chromels("remove","notepad_item_"+t+"_value",!1)}))}})),notepad_window_textarea.addEventListener("input",(function(){let e=notepad_window_textarea.dataset.item_id;if("false"!==e){let t=notepad_window_textarea.value;chromels("set","notepad_item_"+e+"_value",t),notepad_append__get_item_data(e,(function(n){let a=n.time,d="Untitled";d=-1===t.indexOf("\n")?t:t.substring(0,t.indexOf("\n")),""===d&&(d="Untitled"),""===t&&(d="Empty"),d=mt(d,64),notepad_append__set_item_data(e,d,a,(function(){notepad_append__update_item(e)}))}))}})),new Sortable(notepad_window_items,{animation:150,draggable:".notepad_window_item",onSort:function(){notepad_append__index_items_manager()}});